{% extends 'base.html' %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-2xl border border-gray-100">
    <h1 class="text-3xl font-bold text-gray-800 text-center mb-8">{{ page_title }}</h1>
    <form method="post" enctype="multipart/form-data" id="resume-form" class="space-y-6">
        {% csrf_token %}
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="{{ form.full_name.id_for_label }}" class="block text-sm font-medium text-gray-700">Full Name</label>
                {{ form.full_name }}
            </div>
            <div>
                <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700">Email</label>
                {{ form.email }}
            </div>
            <div>
                <label for="{{ form.phone.id_for_label }}" class="block text-sm font-medium text-gray-700">Phone</label>
                {{ form.phone }}
            </div>
            <div>
                <label for="{{ form.profile_image.id_for_label }}" class="block text-sm font-medium text-gray-700">Profile Image</label>
                {{ form.profile_image }}
            </div>
        </div>
        
        <div class="space-y-4">
            <!-- Quill rich text editors for each section -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Summary</label>
                <div id="summary-editor" class="bg-gray-50 border border-gray-300 rounded-md"></div>
                <input type="hidden" name="summary" id="summary-input">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Skills</label>
                <div id="skills-editor" class="bg-gray-50 border border-gray-300 rounded-md"></div>
                <input type="hidden" name="skills" id="skills-input">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Projects</label>
                <div id="projects-editor" class="bg-gray-50 border border-gray-300 rounded-md"></div>
                <input type="hidden" name="projects" id="projects-input">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Education</label>
                <div id="education-editor" class="bg-gray-50 border border-gray-300 rounded-md"></div>
                <input type="hidden" name="education" id="education-input">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Training</label>
                <div id="training-editor" class="bg-gray-50 border border-gray-300 rounded-md"></div>
                <input type="hidden" name="training" id="training-input">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Certificates</label>
                <div id="certificates-editor" class="bg-gray-50 border border-gray-300 rounded-md"></div>
                <input type="hidden" name="certificates" id="certificates-input">
            </div>
        </div>
        
        <button type="submit" class="w-full py-3 px-4 bg-indigo-600 text-white font-medium rounded-lg shadow-md hover:bg-indigo-700 transition-colors">
            Save Resume
        </button>
    </form>
</div>

<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize Quill editors for each field
        var summaryEditor = new Quill('#summary-editor', { theme: 'snow' });
        var skillsEditor = new Quill('#skills-editor', { theme: 'snow' });
        var projectsEditor = new Quill('#projects-editor', { theme: 'snow' });
        var educationEditor = new Quill('#education-editor', { theme: 'snow' });
        var trainingEditor = new Quill('#training-editor', { theme: 'snow' });
        var certificatesEditor = new Quill('#certificates-editor', { theme: 'snow' });

        // Populate editors with existing data on edit view
        {% if form.instance %}
        summaryEditor.root.innerHTML = '{{ form.instance.summary|escapejs|safe }}';
        skillsEditor.root.innerHTML = '{{ form.instance.skills|escapejs|safe }}';
        projectsEditor.root.innerHTML = '{{ form.instance.projects|escapejs|safe }}';
        educationEditor.root.innerHTML = '{{ form.instance.education|escapejs|safe }}';
        trainingEditor.root.innerHTML = '{{ form.instance.training|escapejs|safe }}';
        certificatesEditor.root.innerHTML = '{{ form.instance.certificates|escapejs|safe }}';
        {% endif %}

        // On form submit, copy content from Quill editors to hidden input fields
        document.getElementById('resume-form').onsubmit = function() {
            document.getElementById('summary-input').value = summaryEditor.root.innerHTML;
            document.getElementById('skills-input').value = skillsEditor.root.innerHTML;
            document.getElementById('projects-input').value = projectsEditor.root.innerHTML;
            document.getElementById('education-input').value = educationEditor.root.innerHTML;
            document.getElementById('training-input').value = trainingEditor.root.innerHTML;
            document.getElementById('certificates-input').value = certificatesEditor.root.innerHTML;
        };
    });
</script>
{% endblock %}
